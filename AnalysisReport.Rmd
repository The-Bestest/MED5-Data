---
title: "AnalysisExample_HK"
output:
  html_document: default
  pdf_document: default
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(tidyverse)
library(tidymodels)
library(skimr)
library(stringr)
library(corrplot)
library(RColorBrewer)
library("PerformanceAnalytics")
library("Hmisc")
#library(car)


flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}

```

## BCI - SoA and SoO project analysis
First we need to import all data so we can connect(merge) it

```{r questionnaire, echo=FALSE}
questionnaire <- as_tibble(read.csv(file.path("./","questionnaire.csv")))

orderNumber<-rep(c(1,2,2,1),10)
questionnaire<-cbind(questionnaire,orderNumber)
#cleaning up your data to make it merge friendly
mood <- as_tibble(read.csv(file.path("./","mood.csv"),stringsAsFactors=FALSE)) %>% mutate_if(is.character, stringr::str_replace_all, pattern = " ", replacement = "_")


  #feel free to break down this long command (run it with only the first lines and see how each additional pipe %>% changes the data)
mood <- mood %>%
  pivot_longer(cols = -X, names_to = "Participant") %>%  
  mutate_if(is.character, stringr::str_replace_all, pattern = " ", replacement = "_") %>%
  mutate_if(is.character, stringr::str_replace_all, pattern = "P", replacement = "") %>%
  mutate(Participant = as.numeric(Participant)) %>%
  pivot_wider(names_from = X)
 
```
 
```{r logData, echo=FALSE,message=F, warning=F,results='hide'}
 
 #main game event data
 df <-    list.files(recursive=TRUE ,path = "./data",
                    pattern = "*Game.csv", 
                    full.names = T) %>% 
  tibble(filename = .) %>%   
  mutate(file_contents = map(filename,~ read_csv(file.path(.),na = "NULL")))  %>% 
  unnest(cols=-filename) %>% 
  separate(col=filename,sep="/",into=c("start","folder","Participant","Level","filename")) %>%
  mutate(Participant=as.numeric(str_replace(Participant,"P","")), Level=as.factor(Level))

 # make timestamps more easily usable - express as seconds, set markers when input windows attempts start/end
 df <- df %>%
  # select(SessionID, Timestamp,Participant, Event, InputNumber,InputWindow,InputWindowOrder,TrialResult)%>%
  group_by(SessionID) %>%
  mutate(
    vis_t_time = as.POSIXlt(Timestamp, format = "%Y-%m-%d %H:%M:%OS"),
    hoursecs = (vis_t_time$hour - vis_t_time[1]$hour) * 60 * 60,
    minsecs = (vis_t_time$min - vis_t_time[1]$min) * 60,
    secs = (vis_t_time$sec - vis_t_time[1]$sec),
    timeInSecs = hoursecs + minsecs + secs,
    vis_t_time = NULL,
    hoursecs = NULL,
    minsecs = NULL,
    secs = NULL,
    GameIsOn = ifelse(Event == "GameRunning", 1, 0),
    GameIsOn = cumsum(GameIsOn),
    InputWindowNum = dplyr::lag(ifelse(Event == "GameDecision", 1, 0),default=0),
    InputWindowNum = cumsum(InputWindowNum)) %>%
   ungroup()
 
   
#get times for each input windows
df <- df %>%
  dplyr::group_by(SessionID, InputWindowNum) %>%
  mutate(startTime = min(timeInSecs), timeSinceIWstart = timeInSecs - startTime) %>%
  ungroup()

dfSummary <- df %>%
  dplyr::mutate(successes=ifelse(TrialResult == "AccInput", 1, 0))%>%
  dplyr::group_by(Participant, Level) %>%
  # select(Participant, Level, InputWindowNum, timeSinceIWstart, TrialResult) %>%
  dplyr::summarize(accPerc = sum(successes,na.rm = TRUE) / max(InputWindowNum), 
                          activateDelay = mean(timeSinceIWstart,na.rm = TRUE))

```
OK next data (code is identical apart from the file name patter)
```{r logMeta Data, echo=FALSE,message=F, warning=F,results='hide'}
  
dm <-     list.files(recursive=T,path = "./data",
                     pattern = "*Meta.csv", 
                     full.names = T) %>% 
  tibble(filename = .) %>%   
  mutate(file_contents = map(filename,~ read_csv(file.path(.),na = "NULL")))  %>% 
  unnest(cols=-filename)%>% 
  separate(col=filename,sep="/",into=c("start","folder","Participant","Level","filename")) %>%
  mutate(Participant=as.numeric(str_replace(Participant,"P","")))
```
Sample  data next (code is identical apart from the file name patter)
```{r logSampleData, echo=FALSE,message=F, warning=F,results='hide'}
 
ds <- list.files(recursive=T,path = "./data",
              pattern = "*Sample.csv", 
              full.names = T) %>% 
  tibble(filename = .) %>%   
  mutate(file_contents = map(filename,~ read_csv(file.path(.),na = "NULL")))  %>% 
  unnest(cols=-filename)%>% 
  separate(col=filename,sep="/",into=c("start","folder","Participant","Level","filename"))
 
```

## Initial analysis
```{r theBigMerge}
dfSummary <-dfSummary %>% merge(questionnaire) %>% merge(mood) 
dfSummary <-merge(dfSummary,questionnaire)

dfSummary %>%
  select(-Participant) %>%
  group_by(Level) %>%
  skim()

```

Overview
```{r pressure}
questionnaire %>%
  select(-Participant) %>%
  group_by(Level) %>%
  skim()
```

Correlation overview (you really need to reduce/collapse your Mood questionnaire )

```{r correlationStuff}
# check out this web page on easy summaries for correlations:
#http://www.sthda.com/english/wiki/correlation-matrix-a-quick-start-guide-to-analyze-format-and-visualize-a-correlation-matrix-using-r-software

chart.Correlation(dfSummary[,-c(1,2,9:21)], histogram=TRUE, pch=19)


res2 <- Hmisc::rcorr(as.matrix(dfSummary[,-c(1,2,9:21)]))
flattenCorrMatrix(res2$r, res2$P)

corrplot(cor(dfSummary[dfSummary$Level=="Body",-c(1,2,9:21)]), type="upper",col=brewer.pal(n=8, name="RdYlBu"))
corrplot(cor(dfSummary[dfSummary$Level=="Blocks",-c(1,2,9:21)]), type="upper",col=brewer.pal(n=8, name="RdYlBu"))

dfSummary %>%
  filter(SoA > 2) %>%
  ggplot(aes(x = SoA, y = SoO, colour = Level)) +
  geom_jitter() +
  geom_smooth(method = "lm", fill = NA)


```
```{r PredictingFrustration}
options(pillar.sigfig = 5)
broom::tidy(lm(Frustration~Level*(SoA+SoO+accPerc+activateDelay),data=dfSummary))
broom::tidy(lm(Frustration~SoA+SoO+accPerc+activateDelay,data=dfSummary))
broom::tidy(lm(Frustration~Level,data=dfSummary)) %>%mutate_if(is.numeric, round, 5)
broom::tidy(lm(Frustration~Level*orderNumber,data=dfSummary))
broom::tidy(lm(SoO~Level*orderNumber,data=dfSummary))
broom::tidy(lm(SoA~Level*orderNumber,data=dfSummary))
broom::tidy(lm(Proprioception~orderNumber,data=dfSummary))
broom::tidy(lm(SoO~Level,data=dfSummary))



```

```{r Checking the effect of performance on SoA, SoO, Frustration and Proprioception}
# There seems to be a small effect(-0.3724182)(S = 10664, p-value = 0.0253) on frustration using Spearsman Rho 
cor.test(dfSummary$accPerc, dfSummary$SoA, method="spearman")
cor.test(dfSummary$accPerc, dfSummary$SoO, method="spearman")
cor.test(dfSummary$accPerc, dfSummary$Frustration, method="spearman")
ggplot(dfSummary, aes(x=accPerc,y=Frustration, colour=Level)) + geom_point() + geom_smooth(method = "lm", fill = NA)
cor.test(dfSummary$accPerc, dfSummary$Proprioception, method="spearman")

```
```{r Changing Body to avatar}
class(dfSummary$Level)
dfDataTep <- dfSummary%>%mutate(Level=recode(Level, Body="Avatar"))
dfData <- with(dfDataTep, dfDataTep[order(Level,decreasing = TRUE),])

 
```

```{r Counter-balancing mood test}
#non-parametric data


 dfData %>%
  select(Participant, orderNumber,Level, Q1:Q13) %>%
  pivot_longer(cols = -c(Level, Participant,orderNumber)) %>%
  filter(orderNumber==1) %>% 
  group_by(name) %>% 
  summarise(p=wilcox.test(value~Level,paired=FALSE,exact=FALSE)$p.value) %>%View()
 
```

```{r Counter-balancing levels and performance}
#parametric data
 ParticipantOrder1 <- dfData %>% filter(orderNumber == 1)
 Avatar1 <- ParticipantOrder1 %>% filter(Level=="Avatar")
 Blocks1 <- ParticipantOrder1 %>% filter(Level=="Blocks")
 ParticipantOrder2 <- dfData %>% filter(orderNumber == 2)
Avatar2 <- ParticipantOrder2 %>% filter(Level=="Avatar")
Blocks2 <- ParticipantOrder2 %>% filter(Level=="Blocks")
#Histograms 
qplot(Avatar1$accPerc,
      geom="histogram",
      bins = 50, 
      main = "Performance as Percentages in Avatar 1",
      xlim = c(0, 1),
      ylim = c(0, 3),
      xlab = "Avatar performance")


qplot(Blocks1$accPerc,
      geom="histogram",
      bins = 50,
      xlim = c(0, 1),
      ylim = c(0, 3),
      main = "Performance as Percentages in Blocks 1", 
      xlab = "Blocks performance")

#ordernumber 1
#Use ParticipantOrder1 and Body,Blocks1
#Check for normality(Shapiro Wilks Test)
#The data is normal if the p-value is above 0.05.
SWTestAvatar1 <- shapiro.test(Avatar1$accPerc)
SWTestBlocks1 <- shapiro.test(Blocks1$accPerc)
#homogeneity of variance
#leveneTestorder1 <- leveneTest(ParticipantOrder1$accPerc,group = ParticipantOrder1$Level, center = "median", data = ParticipantOrder1)
#T test Welch's t-test (Does not require variance check)
t.test(Avatar1$accPerc, Blocks1$accPerc)
#ordernumber 2

#parametric data
#Histograms
qplot(Avatar2$accPerc,
      geom="histogram",
      bins = 50,
      xlim = c(0, 1),
      ylim = c(0, 3),
      main = "Performance as Percentages in Avatar 2", 
      xlab = "Avatar performance")

qplot(Blocks2$accPerc,
      geom="histogram",
      bins = 50,
      xlim = c(0, 1),
      ylim = c(0, 3),
      main = "Performance as Percentages in Blocks 2", 
      xlab = "Blocks performance")

#Check for normality(Shapiro Wilks Test)
SWTestAvatar2 <- shapiro.test(Avatar2$accPerc)
SWTestBlocks2 <- shapiro.test(Blocks2$accPerc)
#homogeneity of variance
#leveneTestorder2 <- leveneTest(ParticipantOrder2$accPerc,group = ParticipantOrder2$Level, center = "median", data = ParticipantOrder2)
#T test Welch's t-test (Does not require variance check)
t.test(Avatar2$accPerc, Blocks2$accPerc)

#Check for normality(Shapiro Wilks Test)
shapiro.test(ParticipantOrder1$accPerc)
shapiro.test(ParticipantOrder2$accPerc)
#T test Welch's t-test (Does not require variance check)
t.test(ParticipantOrder1$accPerc, ParticipantOrder2$accPerc)


#Check for normality(Shapiro Wilks Test)
shapiro.test(ParticipantOrder1$accPerc)
shapiro.test(ParticipantOrder2$accPerc)
#T test Welch's t-test (Does not require variance check)
t.test(ParticipantOrder1$accPerc, ParticipantOrder2$accPerc)


```

```{r More t-tests}
dfAvatar<- dfData %>% filter(Level == "Avatar")
dfBlocks <- dfData %>% filter(Level == "Blocks")

#Check for normality(Shapiro Wilks Test)
shapiro.test(dfAvatar$accPerc)
shapiro.test(dfBlocks$accPerc)
#T test Welch's t-test (Does not require variance check)
t.test(dfAvatar$accPerc, dfBlocks$accPerc)


```
```{r Correlation test within ordernumber for SoO on all measurements}
#non-parametric data
#correlation test on measurement within ordernumbers

#Cor.test(lvl1.SoO, lvl1.SoA)
cor.test(ParticipantOrder1$SoO, ParticipantOrder1$SoA, method="spearman", exact = FALSE)
#Cor.test(lvl2.SoO, lvl2.SoA)
cor.test(ParticipantOrder2$SoO, ParticipantOrder2$SoA, method="spearman", exact = FALSE)
#Cor.test(lvl1.SoO, lvl1.proprioception)
cor.test(ParticipantOrder1$SoO, ParticipantOrder1$Proprioception, method="spearman", exact = FALSE)
#Cor.test(lvl2.SoO, lvl2.proprioception)
cor.test(ParticipantOrder2$SoO, ParticipantOrder2$Proprioception, method="spearman", exact = FALSE)
#Cor.test(lvl1.SoO, lvl1.frustration)
cor.test(ParticipantOrder1$SoO, ParticipantOrder1$Frustration, method="spearman", exact = FALSE)
#Cor.test(lvl2.SoO, lvl2.frustration)
cor.test(ParticipantOrder2$SoO, ParticipantOrder2$Frustration, method="spearman", exact = FALSE)

```

```{r Correlation test for SoO all measurements}
#correlation test on SoA
cor.test(dfData$SoO, dfData$SoA, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=SoO,y=SoA, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "SoO") +
  ylab(label = "SoA") +
  geom_smooth(method = "lm", fill = NA)

#correlation test on frustration
cor.test(dfData$SoO, dfData$Frustration, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=SoO,y=Frustration, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "SoO") +
  ylab(label = "Frustration") +
  geom_smooth(method = "lm", fill = NA)

#correlation test on Proprioception
cor.test(dfData$SoO, dfData$Proprioception, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=SoO,y=Proprioception, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "SoO") +
  ylab(label = "Proprioception") +
  geom_smooth(method = "lm", fill = NA)
```

```{r Correlation test for SoA, Frustration and Proprioception}
#correlation test on Frustration
cor.test(dfData$SoA, dfData$Frustration, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=SoA,y=Frustration, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "SoA") +
  ylab(label = "Frustration") +
  geom_smooth(method = "lm", fill = NA)


#correlation test on Proprioception
cor.test(dfData$SoA, dfData$Proprioception, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=SoA,y=Proprioception, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "SoA") +
  ylab(label = "Proprioception") +
  geom_smooth(method = "lm", fill = NA)

#correlation test on Proprioception and Frustration
cor.test(dfData$Proprioception, dfData$Frustration, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=Proprioception,y=Frustration, colour=Level, fill=Level))+ 
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "Proprioception") +
  ylab(label = "Frustration") +
  geom_smooth(method = "lm", fill = NA)
```

```{r Correlation test for Performance on SoO, SoA, Frustration and Proprioception}
#correlation test on SoO
cor.test(dfData$accPerc, dfData$SoO, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=accPerc,y=SoO, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(0,1), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "Performance") +
  ylab(label = "SoO") +
  geom_smooth(method = "lm", fill = NA)

#correlation test on SoA
cor.test(dfData$accPerc, dfData$SoA, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=accPerc,y=SoA, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(0,1), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "Performance") +
  ylab(label = "SoA") +
  geom_smooth(method = "lm", fill = NA)
#correlation test on Frustration
cor.test(dfData$accPerc, dfData$Frustration, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=accPerc,y=Frustration, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(0,1), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "Performance") +
  ylab(label = "Frustration") +
  geom_smooth(method = "lm", fill = NA)
#correlation test on Proprioception
cor.test(dfData$accPerc, dfData$Proprioception, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=accPerc,y=Proprioception, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(0,1), y=c(1, 7))+
  scale_color_manual(values=c("red","blue")) +
  scale_fill_manual(values=c("red","blue")) +
  xlab(label = "Performance") +
  ylab(label = "Proprioception") +
  geom_smooth(method = "lm", fill = NA)

```

```{r Correlation test for Performance on Soa using orderNumber}
#correlation test on SoA order 1
cor.test(ParticipantOrder1$accPerc, ParticipantOrder1$SoA, method="spearman", exact = FALSE)
ggplot(ParticipantOrder1,aes(x=accPerc,y=SoA, colour=Level))+ geom_point() + expand_limits(x=c(0,1), y=c(1, 7)) + geom_smooth(method = "lm", fill = NA)
#correlation test on SoA order 2
cor.test(ParticipantOrder2$accPerc, ParticipantOrder2$SoA, method="spearman", exact = FALSE)
ggplot(ParticipantOrder2,aes(x=accPerc,y=SoA, colour=Level))+ geom_point() + expand_limits(x=c(0,1), y=c(1, 7)) + geom_smooth(method = "lm", fill = NA)
```

```{r Present results}
#This chunk is for all the missing data and graphs for the results sections
MBlocks <- dfData %>% filter(Level=="Blocks")
MAvatar <- dfData %>% filter(Level=="Avatar")

#Median: I manually changed X
median(MBlocks$Proprioception , trim = 0, na.rm = FALSE)
median(MAvatar$Proprioception , trim = 0, na.rm = FALSE)

#Performance
  #boxplot
dfData$Level <- factor(dfData$Level,levels = c("Avatar", "Blocks")

PerformanceBoxplot <- ggplot(dfData, aes(accPerc, y=Level, fill=Level)) +
  geom_bar(stat = "identity") +
  coord_flip() + 
  scale_fill_manual(values=c("red","blue"))+
  ylab(label = "Level") +
  xlab(label = "Performance(%)") +
  guides(fill = guide_legend(reverse=TRUE))+
  labs(fill = "Conditions")+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)
PerformanceBoxplot
  #Histogram
PerformanceHisto <- ggplot(dfData,aes(accPerc, fill=Level))+
   scale_fill_manual(values=c("red","blue"))+
   xlab(label = "Performance") +
   ylab(label = "Fequency") +
   geom_histogram(alpha=0.5,bins=50,position="identity")

#SoO
  #Histogram
SoOHisto <- ggplot(dfData,aes(SoO, fill=Level),xlab=7,ylab=7)+
   scale_fill_manual(values=c("red","blue"))+
   xlab(label = "SoO") +
   ylab(label = "Fequency") +
   geom_histogram(alpha=0.5,bins=14,position="identity")
  #boxplot
SoOBoxplot <- ggplot(dfData, aes(SoO, y=Level, fill=Level)) + 
  coord_flip() + 
  xlab(label = "SoO") +
  ylab(label = "Level") +
  scale_fill_manual(values=c("red","blue"))+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)

#SoA
  #Histogram
SoAHisto <- ggplot(dfData,aes(SoA, fill=Level),xlab=7,ylab=7)+
   scale_fill_manual(values=c("red","blue"))+
   xlab(label = "SoA") +
   ylab(label = "Fequency") +
   geom_histogram(alpha=0.5,bins=14,position="identity")
  #boxplot
SoABoxplot <- ggplot(dfData, aes(SoA, y=Level, fill=Level)) + 
  coord_flip() + 
  xlab(label = "SoA") +
  ylab(label = "Level") +
  scale_fill_manual(values=c("red","blue"))+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)

#Frustation
  #Histogram
FrustationHisto <- ggplot(dfData,aes(Frustration, fill=Level),xlab=7,ylab=7)+
   scale_fill_manual(values=c("red","blue"))+
   xlab(label = "Frustration") +
   ylab(label = "Fequency") +
   geom_histogram(alpha=0.5,bins=14,position="identity")
  #boxplot
FrustationBoxplot <- ggplot(dfData, aes(Frustration, y=Level, fill=Level)) + 
  coord_flip() + 
  xlab(label = "Frustration") +
  ylab(label = "Level") +
  scale_fill_manual(values=c("red","blue"))+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)

#Proprioception 
  #Histogram
ProprioceptionHisto <- ggplot(dfData,aes(Proprioception , fill=Level),xlab=7,ylab=7)+
   scale_fill_manual(values=c("red","blue"))+
   xlab(label = "Proprioception ") +
   ylab(label = "Fequency") +
   geom_histogram(alpha=0.5,bins=14,position="identity")
  #boxplot
ProprioceptionBoxplot <- ggplot(dfData, aes(Proprioception , y=Level, fill=Level)) + 
  coord_flip() + 
  xlab(label = "Proprioception ") +
  ylab(label = "Level") +
  scale_fill_manual(values=c("red","blue"))+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)

 #save plots (Does not work yet)

 # vector1 <- c(PerformanceBoxplot,PerformanceHisto,SoOHisto)
 # 
 # for ( i in seq_along(vector1)) {
 #   png(i+".png", width = 800, height = 600)
 #   plot(i)
 #   dev.off()
 # }

png("PerformanceBoxplot.png", width = 800, height = 600)
plot(PerformanceBoxplot)
dev.off()
png("PerformanceHisto.png", width = 800, height = 600)
plot(PerformanceHisto)
dev.off()
png("SoOHisto.png", width = 800, height = 600)
plot(SoOHisto)
dev.off()
png("SoOBoxplot.png", width = 800, height = 600)
plot(SoOBoxplot)
dev.off()
png("SoAHisto.png", width = 800, height = 600)
plot(SoAHisto)
dev.off()
png("SoABoxplot.png", width = 800, height = 600)
plot(SoOBoxplot)
dev.off()
png("FrustationHsto.png", width = 800, height = 600)
plot(FrustationHisto)
dev.off()
png("FrustationBoxplot.png", width = 800, height = 600)
plot(FrustationBoxplot)
dev.off()


```
```{r AV results}
#This chunk is for all the missing data and graphs for the results sections
#SoO + SoA
ggplot(dfData,aes(x=SoO,y=SoA, colour=Level, fill=Level))+ 
  geom_point(position=position_jitter(h=0.08, w=0.08), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("#E66100","#5D3A9B")) +
  scale_fill_manual(values=c("#E66100","#5D3A9B")) +
  xlab(label = "SoO") +
  ylab(label = "SoA") +
  theme_minimal()+
  geom_smooth(method = "lm", fill = NA)
#performance + frustration
cor.test(dfData$accPerc, dfData$Frustration, method="spearman", exact = FALSE)
ggplot(dfData,aes(x=accPerc,y=Frustration, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(0,1), y=c(1, 7))+
  scale_color_manual(values=c("#E66100","#5D3A9B")) +
  scale_fill_manual(values=c("#E66100","#5D3A9B")) +
  xlab(label = "Performance") +
  ylab(label = "Frustration") +
  theme_minimal()+
  geom_smooth(method = "lm", fill = NA)
#SoA + frustration
ggplot(dfData,aes(x=SoA,y=Frustration, colour=Level, fill=Level))+
  geom_point(position=position_jitter(h=0.1, w=0.0), shape = 21, alpha = 0.5, size = 3) +
  expand_limits(x=c(1,7), y=c(1, 7))+
  scale_color_manual(values=c("#E66100","#5D3A9B")) +
  scale_fill_manual(values=c("#E66100","#5D3A9B")) +
  xlab(label = "SoA") +
  ylab(label = "Frustration") +
  theme_minimal()+
  geom_smooth(method = "lm", fill = NA)

ggplot(dfData, aes(SoO, y=Level, fill=Level)) + 
  coord_flip() + 
  xlab(label = "SoO") +
  ylab(label = "Level") +
  scale_fill_manual(values=c("#E66100","#5D3A9B"))+
  theme_minimal()+
  geom_boxplot(outlier.colour="red", outlier.shape=8,outlier.size=4, alpha=0.5)

```
```{r Wilconson Singed Ranked test ON SoO, SoA, Frustration and Proprioception }


wilcox.test(dfAvatar$SoO, dfBlocks$SoO, paired=TRUE,exact=FALSE)
wilcox.test(dfAvatar$SoA, dfBlocks$SoA, paired=TRUE,exact=FALSE)
wilcox.test(dfAvatar$Frustration, dfBlocks$Frustration, paired=TRUE,exact=FALSE)
wilcox.test(dfAvatar$Proprioception, dfBlocks$Proprioception, paired=TRUE,exact=FALSE)


```


